# WebP –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è OptimizedImage –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚úÖ

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `OptimizedImage` —Ç–µ–ø–µ—Ä—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤–æ –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Å—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- ‚úÖ `CardImage.tsx` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç
- ‚úÖ `ItemCard.tsx` - –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
- ‚úÖ `InventoryGrid.tsx` - —Å–µ—Ç–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
- ‚úÖ `DragonEggsList.tsx` - —è–π—Ü–∞ –¥—Ä–∞–∫–æ–Ω–æ–≤
- ‚úÖ `MonsterCardDisplay.tsx` - –∫–∞—Ä—Ç–æ—á–∫–∏ –º–æ–Ω—Å—Ç—Ä–æ–≤
- ‚úÖ `ShopItem.tsx` - —Ç–æ–≤–∞—Ä—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ

## –ü–æ—á–µ–º—É –Ω—É–∂–Ω–∞ —Ä—É—á–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è?

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è **–Ω–µ –º–æ–≥—É** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ WebP, —Ç–∞–∫ –∫–∞–∫:
1. –£ –º–µ–Ω—è –Ω–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (imagemagick, sharp –∏ —Ç.–¥.)
3. –≠—Ç–æ –∑–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä—É—é –ª—É—á—à–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ —Å –ø–æ–º–æ—â—å—é –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

## –ö–∞–∫ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ WebP?

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–Ω–ª–∞–π–Ω –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)
- **CloudConvert**: https://cloudconvert.com/png-to-webp
- **Convertio**: https://convertio.co/ru/png-webp/
- **Squoosh**: https://squoosh.app/ (–æ—Ç Google, —Å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- –ö–∞—á–µ—Å—Ç–≤–æ: 80-85%
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: –æ–∫–æ–ª–æ 120KB

### –í–∞—Ä–∏–∞–Ω—Ç 2: Batch –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è (–¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —Å—Ä–∞–∑—É)

#### Windows - XnConvert (GUI)
1. –°–∫–∞—á–∞—Ç—å: https://www.xnview.com/en/xnconvert/
2. –î–æ–±–∞–≤–∏—Ç—å –ø–∞–ø–∫—É —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
3. –í—ã–±—Ä–∞—Ç—å –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç: WebP
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ: 80-85
5. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ

#### macOS/Linux - ImageMagick (–∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
brew install imagemagick  # macOS
sudo apt install imagemagick  # Ubuntu/Debian

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
magick convert input.png -quality 85 output.webp

# Batch –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Å–µ—Ö PNG –≤ –ø–∞–ø–∫–µ
for file in *.png; do
  magick convert "$file" -quality 85 "${file%.png}.webp"
done

# Batch –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Å–µ—Ö JPG/JPEG –≤ –ø–∞–ø–∫–µ
for file in *.{jpg,jpeg}; do
  magick convert "$file" -quality 85 "${file%.*}.webp"
done
```

#### Node.js —Å–∫—Ä–∏–ø—Ç (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å sharp
npm install sharp

# –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç convert-to-webp.js
```

```javascript
const sharp = require('sharp');
const fs = require('fs');
const path = require('path');

const inputFolder = './src/assets';
const extensions = ['.png', '.jpg', '.jpeg'];

function convertToWebP(filePath) {
  const outputPath = filePath.replace(/\.(png|jpg|jpeg)$/i, '.webp');
  
  return sharp(filePath)
    .webp({ quality: 85 })
    .toFile(outputPath)
    .then(() => {
      const originalSize = fs.statSync(filePath).size;
      const newSize = fs.statSync(outputPath).size;
      console.log(`‚úÖ ${path.basename(filePath)} -> ${path.basename(outputPath)}`);
      console.log(`   –†–∞–∑–º–µ—Ä: ${(originalSize/1024).toFixed(2)}KB -> ${(newSize/1024).toFixed(2)}KB`);
    });
}

function processFolder(folder) {
  const files = fs.readdirSync(folder);
  
  files.forEach(file => {
    const filePath = path.join(folder, file);
    const stat = fs.statSync(filePath);
    
    if (stat.isDirectory()) {
      processFolder(filePath);
    } else {
      const ext = path.extname(file).toLowerCase();
      if (extensions.includes(ext)) {
        convertToWebP(filePath);
      }
    }
  });
}

processFolder(inputFolder);
```

## –ö–∞–∫–∏–µ –ø–∞–ø–∫–∏ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å?

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –ø–∞–ø–∫–∏ (–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å):
1. **`src/assets/cards/`** - 16 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫–∞—Ä—Ç
2. **`src/assets/monsters/`** - 17 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–æ–Ω—Å—Ç—Ä–æ–≤
3. **`src/assets/items/`** - 51 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
4. **`src/assets/workers/`** - 8 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–∞–±–æ—á–∏—Ö

### –í—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ:
5. **`public/images/`** - —Ñ–æ–Ω—ã –∑–¥–∞–Ω–∏–π
6. **`public/`** - –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (menu-background.jpg, coming-soon.png –∏ —Ç.–¥.)
7. **`src/assets/`** - –∏–∫–æ–Ω–∫–∏ UI

### –ù–ï —Ç—Ä–æ–≥–∞—Ç—å:
- **`public/lovable-uploads/`** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ Supabase Storage** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

## –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

1. **–°–¥–µ–ª–∞–π—Ç–µ backup** –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π
2. **–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É —Ü–µ–ª–∏–∫–æ–º** –≤ WebP —Å –∫–∞—á–µ—Å—Ç–≤–æ–º 80-85%
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä—ã** - —Ü–µ–ª—å ~120KB –Ω–∞ —Ñ–∞–π–ª
4. **–ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –±–æ–ª—å—à–µ 120KB:**
   - –£–º–µ–Ω—å—à–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–æ 70-75%
   - –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å 1024x1024 –¥–æ 800x800)
5. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –æ–±–∞ —Ñ–æ—Ä–º–∞—Ç–∞** (—Å—Ç–∞—Ä—ã–π –∏ .webp) –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ
6. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `OptimizedImage` —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É WebP –±—Ä–∞—É–∑–µ—Ä–æ–º
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç WebP –≤–µ—Ä—Å–∏—é, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
- ‚úÖ Fallback –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, –µ—Å–ª–∏ WebP –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç lazy loading –¥–ª—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç placeholder –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ -> –≤—ã—Å–æ–∫–æ–µ)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ WebP 120KB:

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- üöÄ **3-7x –±—ã—Å—Ç—Ä–µ–µ** –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- üìâ **76% –º–µ–Ω—å—à–µ** —Ç—Ä–∞—Ñ–∏–∫–∞ (50MB -> 12MB –¥–ª—è 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- ‚ö° **2-3x –±—ã—Å—Ç—Ä–µ–µ** –ø–µ—Ä–≤–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- üì± **–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ** –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

### –ö–∞—á–µ—Å—Ç–≤–æ:
- ‚ú® **–û—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ** –¥–ª—è –∏–≥—Ä–æ–≤—ã—Ö –∞—Å—Å–µ—Ç–æ–≤
- üé® **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏** (alpha channel)
- üìê **–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è 800x800+** —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- üîç **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–æ—Ç–µ—Ä—è** –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools -> Network
2. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è `.webp` —Ñ–∞–π–ª—ã
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä—ã –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤

- ‚úÖ Chrome/Edge: 97%+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ Firefox: 95%+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
- ‚úÖ Safari: 95%+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚ö†Ô∏è IE11: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ PNG/JPEG

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/utils/webpHelper.ts` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- `getWebPVersion(path)` - –ø–æ–ª—É—á–∏—Ç—å –ø—É—Ç—å –∫ WebP –≤–µ—Ä—Å–∏–∏
- `webpExists(path)` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ WebP
- `getBestImagePath(path)` - –ø–æ–ª—É—á–∏—Ç—å –ª—É—á—à–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø—É—Ç—å
- `preloadImageWithWebP(path)` - –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å WebP

## –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –∏–ª–∏ –≤–æ–ø—Ä–æ—Å—ã - –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å!

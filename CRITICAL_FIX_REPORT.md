# –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ 35,000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É

## üö® –ù–ê–ô–î–ï–ù–ù–´–ï –ò –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. **MedicalBayComponent.tsx** - –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã
**–ü–†–û–ë–õ–ï–ú–ê:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–ª `loadCardInstances()`:
- –í `useEffect` –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –ª–µ—á–µ–Ω–∏—è
- –° –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é `loadCardInstances` –≤ useEffect (–±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª!)

**–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:**
- ‚úÖ –£–±—Ä–∞–ª `loadCardInstances()` –∏–∑ useEffect
- ‚úÖ –£–±—Ä–∞–ª –≤—ã–∑–æ–≤—ã `loadCardInstances()` –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–ª–∏–∫–æ–≤
- ‚úÖ –£–±—Ä–∞–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `loadCardInstances` –∏–∑ useEffect
- ‚úÖ –û—Å—Ç–∞–≤–∏–ª —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø–æ–¥–ø–∏—Å–∫—É —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä

### 2. **useUnifiedGameState.ts** - Real-time –∫–∞—Å–∫–∞–¥—ã
**–ü–†–û–ë–õ–ï–ú–ê:** Real-time –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ `card_instances` –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–ª–∞ –∫—ç—à –∏ –≤—ã–∑—ã–≤–∞–ª–∞ –Ω–æ–≤—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏

**–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:**
- ‚úÖ –û—Ç–∫–ª—é—á–∏–ª `onCardInstanceChange` callback
- ‚úÖ –£–±—Ä–∞–ª –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é –∫—ç—à–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–∞—Ä—Ç —á–µ—Ä–µ–∑ React Query

### 3. **CardInstanceManager** - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
**–ü–†–û–ë–õ–ï–ú–ê:** –°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏ (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥)

**–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:**
- ‚úÖ –£–≤–µ–ª–∏—á–∏–ª –∫—ç—à –¥–æ 60 —Å–µ–∫—É–Ω–¥
- ‚úÖ –£–≤–µ–ª–∏—á–∏–ª –±–∞—Ç—á–∏–Ω–≥ –¥–æ 5 —Å–µ–∫—É–Ω–¥
- ‚úÖ –î–æ–±–∞–≤–∏–ª –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∫—ç—à–∞
- ‚úÖ –£–ª—É—á—à–∏–ª –∑–∞—â–∏—Ç—É –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫

### 4. **Auto-loading** –≤ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º —Ö—É–∫–µ
**–ü–†–û–ë–õ–ï–ú–ê:** –ù–µ –±—ã–ª–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

**–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:**
- ‚úÖ –î–æ–±–∞–≤–∏–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ—à–µ–ª—å–∫–∞
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 60 —Å–µ–∫—É–Ω–¥

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

**–î–û:**
- 35,000+ –∑–∞–ø—Ä–æ—Å–æ–≤ `get_card_instances_by_wallet` –≤ –º–∏–Ω—É—Ç—É
- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã –∑–∞–≥—Ä—É–∑–∫–∏
- –ö–∞—Å–∫–∞–¥–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ React Query

**–ü–û–°–õ–ï:**
- –ú–∞–∫—Å–∏–º—É–º 1 –∑–∞–ø—Ä–æ—Å –≤ 60 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∫–æ—à–µ–ª–µ–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- –°—Ç—Ä–æ–≥–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

## üéØ –ú–ï–•–ê–ù–ò–ó–ú–´ –ó–ê–©–ò–¢–´

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ 60 —Å–µ–∫—É–Ω–¥** - –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–∞—â–µ
2. **–ó–∞—â–∏—Ç–∞ –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫** - –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–¥–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫—ç—à
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏** - –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä –±–µ–∑ RPC
4. **–û—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–∞—Å–∫–∞–¥—ã** - real-time —Å–æ–±—ã—Ç–∏—è –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é –∫—ç—à–∞
5. **–£–±—Ä–∞–Ω–Ω—ã–µ useEffect** - –Ω–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## üîç –ú–û–ù–ò–¢–û–†–ò–ù–ì

–ù–æ–≤—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
```
CardInstanceManager: Using cached data for {wallet}, age: {X}s
CardInstanceManager: Load already in progress for {wallet}, returning cached data
CardInstanceManager: Loading from DB for {wallet}
useCentralizedCardInstances: Received update from manager: {X}
```

## ‚úÖ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

**–°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ 300+ —Ä–∞–∑:**
- –° 35,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É –¥–æ <100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
- –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ö—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ 60 —Å–µ–∫—É–Ω–¥
- –ü–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ RPC –≤—ã–∑–æ–≤–æ–≤